parameters:
  - name: containerRegistry
    type: string

steps:
  - task: Docker@2
    displayName: acr_login
    inputs:
      command: login
      containerRegistry: ${{ parameters.containerRegistry }}
  - script: |
      cicd/scripts/docker_build_push.sh $PWD $BUILD_BUILDID
    displayName: build and push updated images
    env:
      TARGET_BRANCH: $(System.PullRequest.TargetBranch)
      SOURCE_BRANCH: $(System.PullRequest.SourceBranch)
